// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// 定义生成文件, 生成文件可用于typescript提示
generator client {
    provider = "prisma-client-js"
}

// 数据库连接相关信息
datasource db {
    provider = "sqlite"
    url      = env("DATABASE_URL")
}

model Transaction {
    id        Int      @id @default(autoincrement())
    from      String
    to        String
    timestamp DateTime
    gasFee    Float
}

model SupBlock {
    id        Int    @id @default(autoincrement())
    publicKey String
    address   String
}

model UploadHash {
    id              Int    @id @default(autoincrement())
    transactionHash String @unique @map("transaction_hash")
    from            String
    to              String
    types           Int
    infoHash        String
    tA              String
    tB              String
    index           String
    blockNum        Int
    gas             Int
    // @@index([from, to, types], name: "idx_upload_hash") // 创建索引, 提高搜索性能
}

model UploadNum {
    id              Int     @id @default(autoincrement())
    transactionHash String  @unique @map("transaction_hash")
    from            String
    to              String
    types           Int
    ni              String
    ri              String
    t               String // 执行次数
    blockNum        Int
    gas             Int
    correctness     Boolean
    numHashA        String
    numHashB        String

    @@index([from, to, types], name: "idx_upload_num")
}

model ReuploadNum {
    id              Int    @id @default(autoincrement())
    transactionHash String @unique @map("transaction_hash")
    from            String
    to              String
    types           Int
    ni              String
    ri              String
    blockNum        Int
    gas             Int
    originalHashA   String
    originalHashB   String

    @@index([from, to, types], name: "idx_reupload_num")
}

// 定义 `App2RelayEvent` 表
model App2RelayEvent {
    id              Int    @id @default(autoincrement()) // 自动生成的主键
    transactionHash String @unique @map("transaction_hash") // 交易哈希
    from            String @map("from_address") // 发送方地址
    relay           String @map("relay_address") // 中继地址
    data            String // 事件中的数据
    dataHash        String @map("data_hash") // 数据哈希值
    blockNum        Int
    gas             Int
}

// 定义 `Pre2NextEvent` 表
model Pre2NextEvent {
    id              Int    @id @default(autoincrement()) // 自动生成的主键
    transactionHash String @unique @map("transaction_hash")
    from            String @map("from_address") // 发送方地址
    relay           String @map("relay_address") // 中继地址
    data            String // 事件中的数据
    encryptedToken  String
    dataHash        String @map("data_hash")
    blockNum        Int
    gas             Int
}

// 定义 `RelayResEvidenceEvent` 表
model RelayResEvidenceEvent {
    id                    Int    @id @default(autoincrement()) // 自动生成的主键
    transactionHash       String @unique @map("transaction_hash")
    relayAnonymousAccount String @map("relay_anonymous_account") // 中继匿名账户
    appTempAccount        String @map("app_temp_account") // 应用临时账户
    data                  String // 事件中的数据
    dataHash              String @map("data_hash")
    app2RelayResEvidence  String @map("app2_relay_response_evidence")
    pre2NextResEvidence   String @map("pre2_next_response_evidence")
    blockNum              Int
    gas                   Int
}
